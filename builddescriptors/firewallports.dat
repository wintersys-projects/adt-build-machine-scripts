Always allow VPC_RANGE (don't need to configure it)

if authenticator=1 and reverse proxy = 1 and autoscaler = 1 webservers!=0 and DNS_CHOICE=DO, LIN,EXO or Vultr

AUTHENTICATOROPENPORTS:ICMP SSH_PORT 443
REVERSEPROXYOPENPORTS:ICMP SSH_PORT 443
AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT 443
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT

if authenticator=0 and reverse proxy = 1 and autoscaler = 1 webservers!=0 and DNS_CHOICE=DO, LIN,EXO or Vultr

REVERSEPROXYOPENPORTS:ICMP SSH_PORT 443
AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT 443
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT

if reverse proxy = 1 and authenticator=0 and autoscaler = 1 webservers!=0 and DNS_CHOICE=cloudflare

REVERSEPROXYOPENPORTS:ICMP SSH_PORT CLOUDFLARE
AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT 443
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT

if reverse proxy=0 and authenticator=0 and autoscaler=1 and webservers!=0

AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT 443
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT

if authentiator=1 and autoscaler=1 and webservers!=0

AUTHENTICATOROPENPORTS:ICMP SSH_PORT 443
AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT

if authenticator=1 and reverseproxy=1 and autoscaler=1 webservers!=0

AUTHENTICATOROPENPORTS:ICMP 443
REVERSEPROXYOPENPORTS:ICMP SSH_PORT
AUTOSCALEROPENPORTS:ICMP SSH_PORT
WEBSERVEROPENPORTS:ICMP SSH_PORT 443
DATABASEOPENPORTS:ICMP SSH_PORT DB_PORT
